# 设置黑白名单（针对高防实例IP）

黑白名单（针对高防实例IP）允许您针对访问DDoS高防实例的请求来源IP设置封禁或者放行。您可以根据业务需要为DDoS高防实例单独配置黑名单、白名单（例如，添加和移除IP）。本文介绍了黑白名单的具体操作方法。

已开通DDoS高防（新BGP）或DDoS高防（国际）实例。更多信息，请参见[开通DDoS高防（新BGP&国际）](/intl.zh-CN/DDoS高防（新BGP&国际）用户指南/开通DDoS高防（新BGP&国际）.md)。

黑白名单（针对高防实例IP）对单个DDoS高防实例生效。

黑名单IP的访问流量将被DDoS高防实例直接丢弃。黑名单IP存在有效期，具体说明如下：

-   通过手动添加的IP，在添加时需要指定其有效期。最短可以设置5分钟，最长可以设置7天。
-   黑名单中包含DDoS高防智能防御算法标记的恶意IP。如果是智能防御算法标记的恶意IP，其有效期由智能防御算法动态计算，最短5分钟，最长1小时。如果恶意IP在有效期内有持续的恶意攻击行为，系统将自动延长有效期。

白名单IP的访问流量将被DDoS高防实例直接放行。白名单IP永久生效。

如果黑名单和白名单中的IP出现冲突，遵循白名单优先原则。如果某个IP已经在白名单中，则无法被添加到黑名单中；这种情况下，您必须先将改IP从白名单中移除，才能将该IP添加到黑名单中。

1.  登录[DDoS高防控制台](https://yundun.console.aliyun.com/?p=ddoscoo)。

2.  在顶部菜单栏左上角处，选择服务所在地域：

    -   **中国内地**：选择该地域将跳转到**DDoS高防（新BGP）**控制台。
    -   **非中国内地**：选择该地域将跳转到**DDoS高防（国际）**控制台。
    您可以通过切换地域分别管理和配置DDoS高防（新BGP）和DDoS高防（国际）实例。在使用DDoS高防服务时，请确认您已选择正确的地域。

3.  在左侧导航栏，选择**防护设置** \> **通用防护策略**。

4.  在**基础设施DDoS防护**页签下，从左侧实例列表中选择要设置的DDoS高防实例。

    您可以使用实例ID、实例备注搜索目标实例。

5.  定位到**黑/白名单（针对高防实例IP）**区域，单击**设置**。

    ![黑白名单](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5217947061/p36905.png)

6.  在设置黑/白名单页面，单击**黑名单**或**白名单**，分别管理黑名单、白名单。

    ![黑白名单设置](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9941919951/p72934.png)

    -   关于黑名单管理的具体操作，请参见[步骤7](#step_3n4_8jj_8fq)。
    -   关于白名单管理的具体操作，请参见[步骤8](#step_6d5_urp_2lv)。
7.  管理黑名单。

    支持的操作包括：

    -   手动添加黑名单IP

        1.  单击**手动添加**。

            黑名单中最多支持手动添加2000个IP。多个地址请使用空格或换行分隔。

        2.  在黑名单配置对话框，输入要拉黑的请求来源IP并选择**黑名单有效期**。

            ![拉黑支持自定义时间](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5217947061/p130719.png)

            **黑名单有效期**最短可以设置5分钟，最长可以设置7天，支持自定义黑名单有效期（单位：秒）。

        3.  单击**添加**。
        成功添加黑名单IP后，新添加的黑名单IP在有效期内的所有访问请求将被丢弃。有效期过后，黑名单IP将从黑名单配置中自动移除；如果您还需要丢弃该IP的访问请求，可以重新将该IP添加为黑名单IP。

    -   搜索黑名单IP：在搜索框中输入IP关键字，单击查询图标，即可查询黑名单中符合条件的IP。
    -   清空黑名单：单击**清空黑名单**，将当前黑名单中的所有IP直接移除。您也可以单击某个IP后的**删除**，单独将其从黑名单中移除。
    -   下载黑名单

        1.  单击**下载**，下发黑名单导出任务。
        2.  在导出任务已下发提示中，单击**确定**。

            ![导出任务下发](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9941919951/p69619.png)

        3.  关闭当前设置黑/白名单页面，返回上一级页面。
        4.  单击页面右上角![任务图标](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9941919951/p69825.png)图标，展开任务列表。
        5.  定位到黑名单导出任务，等待**任务状态**变为**已完成**，单击其操作列下的**下载**。

            ![任务列表,黑名单导出](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9941919951/p69620.png)

        成功下载黑名单IP到本地后，您可以打开下载的TXT文件查看黑名单明细。

8.  管理白名单。

    支持的操作包括：

    -   手动添加白名单IP

        1.  单击**手动添加**。
        2.  在白名单配置对话框，输入要放行的请求来源IP。

            **说明：** 白名单中最多支持手动添加2000个IP。多个IP地址请使用空格或换行分隔。

            ![白名单配置](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9941919951/p69623.png)

        3.  单击**添加**。
        成功添加白名单IP后，新添加的白名单IP永久有效，其所有访问请求均直接放行。

    -   搜索白名单IP：在搜索框中输入IP关键字，单击查询图标，即可查询白名单中符合条件的IP。
    -   清空白名单：单击**清空白名单**，将当前白名单中的所有IP直接移除。您也可以单击某个IP后的**删除**，单独将其从白名单中移除。
    -   下载白名单

        1.  单击**下载**，下发白名单导出任务。
        2.  在导出任务已下发提示中，单击**确定**。

            ![导出任务下发](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9941919951/p69619.png)

        3.  关闭当前设置黑/白名单页面，返回上一级页面。
        4.  单击页面右上角![任务图标](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9941919951/p69825.png)图标，展开任务列表。
        5.  定位到白名单导出任务，等待**任务状态**变为**已完成**，单击其操作列下的**下载**。

            ![任务列表,黑名单导出](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9941919951/p69620.png)

        成功下载白名单IP到本地后，您可以打开下载的TXT文件查看白名单明细。


